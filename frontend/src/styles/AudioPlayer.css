/* ===================== VARIABLES ===================== */
:root{
  --player-w: 420px;
  --player-h: 360px;

  --selector-gap-top: calc(env(safe-area-inset-top) + 64px + 10px);

  --cards-left-max-w: 100vw;
  --card-w: clamp(340px, calc(var(--player-w) - 40px), 320px);
  --card-h-desired: clamp(340px, calc(var(--card-w) * 1.18), 520px);
  --cards-top-gap: 6px;
  --cards-bottom-gap: 20px;
  --cards-max-available: calc(100vh - (var(--selector-gap-top) + var(--cards-top-gap)) - (var(--player-h) + var(--cards-bottom-gap)));
  --card-h: min(var(--card-h-desired), var(--cards-max-available));

  --panel-right-gap: max(12px, env(safe-area-inset-right));
  --panel-top-gap: calc(env(safe-area-inset-top) + 40px);
  --panel-bottom-gap: max(12px, env(safe-area-inset-bottom));
  --panel-w: 520px;

  --accent-blue: #6490f6;
}

/* ===================== MINI GLASS PLAYER ===================== */
.audio-player-square.stereo{
  width: var(--player-w);
  height: var(--player-h);
  display:flex; flex-direction:column; align-items:center;
  padding:14px; border-radius:18px;
  background: rgba(255,255,255,0.10);
  border: 1px solid rgba(255,255,255,0.22);
  backdrop-filter: blur(12px) saturate(1.05);
  -webkit-backdrop-filter: blur(12px) saturate(1.05);
  color:#e8edf3;
  box-shadow: 0 12px 36px rgba(0,0,0,0.28), inset 0 0 0 1px rgba(255,255,255,0.06);
  overflow:hidden;
}
.ap-header{ width:100%; display:flex; align-items:center; justify-content:space-between; gap:8px; }
.ap-title{ display:flex; flex-direction:column; gap:4px; }
.ap-now{ font-weight:700; letter-spacing:.25px; opacity:.95; }
.ap-trackline{ opacity:.9; font-size:.92rem; white-space:nowrap; overflow:hidden; text-overflow:ellipsis; }
.ap-artist{ font-weight:700; }
.ap-sep{ opacity:.55; margin:0 6px; }
.ap-titletext{ opacity:.9; }
.ap-error{ color:#ffb3b3; font-size:12px; padding:2px 6px; border:1px solid rgba(255,179,179,0.45); border-radius:8px; background:rgba(255,179,179,0.08); }

/* Visualizer */
.ap-canvas{
  width:100%; height:86px; border-radius:12px;
  background: rgba(255,255,255,0.08);
  border:1px solid rgba(255,255,255,0.18);
  box-shadow: inset 0 0 12px rgba(0,0,0,0.22);
  margin-bottom: 6px;
}

/* Turntable block */
.tt-wrap{
  width:100%;
  height:130px;
  display:flex; align-items:center; justify-content:center;
  margin-bottom: 2px;
  padding: 0 10px; /* gives breathing room on both sides */
}
.tt-flex{
  width:100%;
  height:100%;
  display:flex; align-items:center; justify-content:center; gap:12px;
}
.tt-knob-col{
  flex: 0 0 auto;
  display:flex; align-items:center; justify-content:center;
  margin-left: 8px; /* keeps it off the left wall on desktop & mobile */
}
.turntable-svg{ width:100%; height:130px; overflow:visible; }

/* Transparent icon buttons */
.tt-ghost-btn circle{ transition: transform .12s ease, stroke .2s ease; }
.tt-ghost-btn:hover circle{ transform: translateY(-1px); stroke: #ffffff; }

/* Seek row (slider + ±10s) */
.ap-seek-row{
  margin-top: 10px;             /* base spacing (mobile overrides below) */
  width:100%;
  display:flex; align-items:center; justify-content:space-between; gap:10px;
}
@media (min-width: 769px){
  .ap-seek-row{ margin-top: 16px; }   /* extra top margin on desktop for the whole row */
}
.ap-btn{
  background: rgba(255,255,255,0.14);
  border:1px solid rgba(255,255,255,0.28);
  color:#f2f6fb; padding:8px 12px; border-radius:10px; cursor:pointer;
  box-shadow:0 6px 18px rgba(0,0,0,0.22);
  transition: transform .15s ease, background .2s ease;
}
.ap-btn.small{ font-size:.9rem; padding:10px 10px; margin-left: 12px;}
.ap-btn.xsmall{ font-size:.8rem; padding:4px 8px; line-height:1; }
.ap-btn:hover{ transform: translateY(-1px); background: rgba(255,255,255,0.18); }

/* Desktop horizontal volume */
.ap-volume{
  --accent: var(--accent-blue);
  --bg: rgba(255,255,255,0.35);
  --vol: 0.85;
  appearance:none; -webkit-appearance:none; -moz-appearance:none;
  width:62%; height:8px; border-radius:999px; outline:none;
  background:
    linear-gradient(var(--accent), var(--accent)) 0/ calc(var(--vol)*100%) 100% no-repeat,
    var(--bg);
  border:1px solid rgba(255,255,255,0.25);
  box-shadow: inset 0 2px 8px rgba(0,0,0,0.2);
}
.ap-volume::-webkit-slider-thumb{
  -webkit-appearance:none; width:16px; height:16px; border-radius:50%;
  background:#fff; border:1px solid rgba(0,0,0,0.15);
  box-shadow:0 2px 8px rgba(0,0,0,0.25);
}
.ap-volume::-moz-range-thumb{
  width:16px; height:16px; border-radius:50%;
  background:#fff; border:1px solid rgba(0,0,0,0.15);
  box-shadow:0 2px 8px rgba(0,0,0,0.25);
}
.ap-volume::-moz-range-track{ background: transparent; }
.ap-volume::-moz-range-progress{
  background: var(--accent);
  height:8px; border-radius:999px;
}

/* ===================== (OLD KNOB STYLES — NOT USED) ===================== */
/* kept commented for reference
.knob-surround{ ... }
*/

/* ===================== MOBILE MINI VOLUME + QUICK SEEK ===================== */
/* Container column (left side of the turntable) */
.mobile-mini{
  display:flex;
  flex-direction:column;
  align-items:center;
  gap:6px;

  /* NEW: make the whole widget wider and give it its own width so
     the buttons align perfectly under the slider */
  width: clamp(150px, 44vw, 340px);
}

/* Slider itself */
.mobile-mini-volume{
  --accent: var(--accent-blue);
  --bg: rgba(255,255,255,0.35);
  --vol: 0.85;
  appearance:none; -webkit-appearance:none; -moz-appearance:none;

  /* NEW: take the full width of the widget for more presence */
  width: 100%;
  height:6px; border-radius:999px; outline:none;
  background:
    linear-gradient(var(--accent), var(--accent)) 0/ calc(var(--vol)*100%) 100% no-repeat,
    var(--bg);
  border:1px solid rgba(255,255,255,0.25);
  box-shadow: inset 0 2px 6px rgba(0,0,0,0.25);
}
.mobile-mini-volume::-webkit-slider-thumb{
  -webkit-appearance:none; width:14px; height:14px; border-radius:50%;
  background:#fff; border:1px solid rgba(0,0,0,0.15);
  box-shadow:0 2px 6px rgba(0,0,0,0.2);
}
.mobile-mini-volume::-moz-range-thumb{
  width:14px; height:14px; border-radius:50%;
  background:#fff; border:1px solid rgba(0,0,0,0.15);
  box-shadow:0 2px 6px rgba(0,0,0,0.2);
}
.mobile-mini-volume::-moz-range-track{ background: transparent; }
.mobile-mini-volume::-moz-range-progress{
  background: var(--accent);
  height:6px; border-radius:999px;
}

/* Buttons row under the slider */
.mobile-mini-seek{
  display:flex;
  align-items:center;
  justify-content:space-between; /* NEW: align to the widget’s width */
  gap:10px;
  width: 100%; 
  margin-left: 2%;
                   /* NEW: match slider width */
}
/* NEW: make both buttons equal width and perfectly aligned */
.mobile-mini-seek .ap-btn.xsmall{
 display: none;
  
}

/* ===================== CARDS BELOW SELECTOR ===================== */
.cards-below-selector{ left:auto !important; right:auto !important; transform:none !important; }
.cards-below-selector.left{
  position: fixed;
  top: calc(var(--selector-gap-top) + var(--cards-top-gap));
  left: max(16px, env(safe-area-inset-left));
  width: min(var(--cards-left-max-w), 96vw);
  z-index: 1003;
}
.cards-below-selector.left .cards-wrap{ display:flex; justify-content:flex-start; }
.cards-below-selector.left .swiper{ width: var(--card-w); height: var(--card-h); margin:0; }
.cards-below-selector.left .swiper .swiper-slide{ width: var(--card-w) !important; height: var(--card-h) !important; display:block; }
.card-slide{
  width:100%; height:100%; overflow:hidden; border-radius:12px; background:#dfe3ee;
  box-shadow: 0 0.5px 0 1px rgba(255,255,255,0.25) inset, 0 1px 0 0 rgba(255,255,255,0.65) inset, 0 6px 18px rgba(0,0,0,0.12);
  display:grid; grid-template-rows:1.8fr 1.2fr;
}
.card-slide img{ aspect-ratio:1/1; border-radius:10px; margin:10px; width:calc(100% - 20px); height:auto; object-fit:cover; }
.card-meta{ display:flex; flex-direction:column; justify-content:center; align-items:flex-start; padding:12px 16px 16px; text-align:left; direction: rtl; }
.card-meta .artist, .card-meta .title{ white-space:nowrap; overflow:hidden; text-overflow:ellipsis; width:100%; color: var(--accent-blue); font-weight:800; }
.card-meta .artist{ font-size:1.12rem; line-height:1.22; }
.card-meta .title{ font-size:1.06rem; line-height:1.2; }

/* ===================== RIGHT GLASS PLAYLIST ===================== */
.playlist-right{
  position:fixed; top: var(--panel-top-gap); right: var(--panel-right-gap);
  width: min(var(--panel-w), 92vw);
  height: calc(100vh - var(--panel-top-gap) - var(--panel-bottom-gap));
  border-radius: 16px;
  background: linear-gradient(135deg, rgba(255,255,255,0.14), rgba(255,255,255,0.06));
  border: 1px solid rgba(255,255,255,0.28);
  backdrop-filter: blur(20px) saturate(1.25); -webkit-backdrop-filter: blur(20px) saturate(1.25);
  box-shadow: 0 18px 48px rgba(0,0,0,0.3), inset 0 1px 0 rgba(255,255,255,0.2);
  overflow: hidden; z-index: 1002;
}
.playlist-right .playlist-scroller{ height:100%; overflow-y:auto; padding:12px; scrollbar-width:none; }
.playlist-right .playlist-scroller::-webkit-scrollbar{ width:0; height:0; }
.playlist-item{
  display:grid; grid-template-columns:64px 1fr; gap:12px; align-items:center;
  padding:12px; border-radius:14px; background: rgba(255,255,255,0.07);
  border:1px solid rgba(255,255,255,0.16); color:#e5e5e5; cursor:pointer;
  transition: background .18s ease, border-color .18s ease, transform .12s ease; margin-bottom:10px;
}
.playlist-item:hover{ background: rgba(255,255,255,0.12); border-color: rgba(255,255,255,0.26); transform: translateY(-1px); }
.playlist-item img{ width:64px; height:64px; border-radius:10px; object-fit:cover; }
.playlist-item .song .artist{ font-weight:800; font-size:1rem; }
.playlist-item .song .title{ opacity:.9; font-size:.92rem; }
.active-playlist-item{ background: rgba(255,255,255,0.16); border-color: rgba(255,255,255,0.32); box-shadow: inset 0 0 0 1px rgba(255,255,255,0.15); }

/* ===================== MOBILE HAMBURGER PLAYLIST ===================== */
.mobile-pl-btn{
  position: fixed !important;
  top: calc(env(safe-area-inset-top) + 10px);
  right: calc(env(safe-area-inset-right) + 12px);
  z-index: 2001; display:none;
  padding: 10px 12px;
  border-radius: 12px;
  border: 1px solid rgba(255,255,255,0.28);
  background: rgba(255,255,255,0.14);
  color: #eef3ff;
  font-size: 1rem; line-height: 1;
  backdrop-filter: blur(12px) saturate(1.1); -webkit-backdrop-filter: blur(12px) saturate(1.1);
  box-shadow: 0 10px 30px rgba(0,0,0,0.25);
  pointer-events: auto;
}
.mobile-pl-btn:active{ transform: translateY(1px); }

.mobile-pl-drawer{
  position: fixed !important;
  top: calc(env(safe-area-inset-top) + 58px);
  left: max(8px, env(safe-area-inset-left));
  right: max(8px, env(safe-area-inset-right));
  z-index: 2000; height:168px; border-radius:16px;
  background: linear-gradient(135deg, rgba(255,255,255,0.18), rgba(255,255,255,0.08));
  border: 1px solid rgba(255,255,255,0.28);
  backdrop-filter: blur(18px) saturate(1.25); -webkit-backdrop-filter: blur(18px) saturate(1.25);
  box-shadow: 0 18px 46px rgba(0,0,0,0.28), inset 0 1px 0 rgba(255,255,255,0.2);
  transform: translateY(-140%); transition: transform .28s ease; overflow: hidden; display:none;
}
.mobile-pl-drawer.open{ transform: translateY(0); }

.mobile-pl-header{ height:36px; display:flex; align-items:center; justify-content:space-between; padding:6px 10px; font-weight:700; letter-spacing:.2px; color:#eaf1ff; }
.mobile-pl-close{ border:1px solid rgba(255,255,255,0.28); background: rgba(255,255,255,0.14); color:#fff; border-radius:10px; padding:4px 8px; }
.mobile-pl-row{ display:flex; gap:10px; padding:8px 10px 12px; overflow-x:auto; scrollbar-width:none; -webkit-overflow-scrolling:touch; }
.mobile-pl-row::-webkit-scrollbar{ height:0; }
.mobile-track-card{
  min-width:120px; max-width:140px; display:flex; flex-direction:column; align-items:stretch; text-align:start;
  border-radius:12px; background: rgba(255,255,255,0.10); border:1px solid rgba(255,255,255,0.22);
  color:#eaf1ff; padding:6px; box-shadow: inset 0 0 0 1px rgba(255,255,255,0.04), 0 8px 16px rgba(0,0,0,0.22);
}
.mobile-track-card img{ width:100%; height:74px; object-fit:cover; border-radius:8px; margin-bottom:6px; }
.mobile-track-card .mtc-artist{ font-size:.82rem; font-weight:800; color: var(--accent-blue); white-space:nowrap; overflow:hidden; text-overflow:ellipsis; }
.mobile-track-card .mtc-title{ font-size:.8rem; opacity:.95; white-space:nowrap; overflow:hidden; text-overflow:ellipsis; }
.mobile-track-card.active{ background: rgba(255,255,255,0.18); border-color: rgba(255,255,255,0.32); }

/* ===================== RESPONSIVE ===================== */
@media (max-width: 1024px){
  :root{
    --panel-w: 460px;
    --card-w: clamp(320px, calc(var(--player-w) - 40px), 480px);
    --card-h-desired: clamp(320px, calc(var(--card-w) * 1.12), 500px);
  }
}

@media (max-width: 768px){
  :root{ --player-h: 238px; }

  .audio-player-square.stereo{ padding:10px; border-radius:14px; }
  .ap-canvas{ height:74px; margin-bottom:6px; }

  .tt-wrap, .turntable-svg{ height:108px; }
  .tt-wrap{ padding: 0 14px; } /* ensures the left column never clips */
  .tt-flex{ gap: 12px; justify-content:center; align-items:center; }

  /* NEW: push the left widget further to the right and give extra left margin */
  .tt-knob-col{ margin-left: 26px; }

  /* hide desktop slider on mobile */

  .ap-seek-row{ margin-top: 12px; } /* slightly tighter on mobile */

  .cards-below-selector,
  .playlist-right { display: none !important; }

  .mobile-pl-btn,
  .mobile-pl-drawer { display: block; }


}

@media (max-width: 420px){
  :root{
    --card-w: clamp(300px, calc(var(--player-w) - 42px), 440px);
    --card-h-desired: clamp(300px, calc(var(--card-w) * 1.16), 480px);
  }
}
