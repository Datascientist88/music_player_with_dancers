/* ===================== VARIABLES ===================== */
:root{
  /* Player sizing (used to anchor cards/player relationship) */
  --player-w: 420px;                 /* matches App.css default */
  --player-h: 360px;

  /* Top selector bar height */
  --selector-gap-top: calc(env(safe-area-inset-top) + 64px + 10px);

  /* Cards: width slightly smaller than player, height is auto-clamped */
  --cards-left-max-w: 100vw;
  --card-w: clamp(340px, calc(var(--player-w) - 40px), 320px);

  /* Desired tallness, then clamp to available vertical space (see below) */
  --card-h-desired: clamp(340px, calc(var(--card-w) * 1.18), 520px);

  /* Margins to keep the stack comfy between selector (top) and player (bottom) */
  --cards-top-gap: 6px;             /* space under selector */
  --cards-bottom-gap: 20px;          /* space above player */

  /* Available vertical space for the stack; prevents overlap with player */
  --cards-max-available: calc(
    100vh - (var(--selector-gap-top) + var(--cards-top-gap))
          - (var(--player-h) + var(--cards-bottom-gap))
  );

  /* Final card height = desired height but never more than available space */
  --card-h: min(var(--card-h-desired), var(--cards-max-available));

  /* Right playlist panel */
  --panel-right-gap: max(12px, env(safe-area-inset-right));
  --panel-top-gap: calc(env(safe-area-inset-top) + 40px);
  --panel-bottom-gap: max(12px, env(safe-area-inset-bottom));
  --panel-w: 520px;

  /* Accent */
  --accent-blue: #6490f6;
}

/* ===================== MINI GLASS PLAYER (unchanged) ===================== */
.audio-player-square.stereo{
  width: var(--player-w);
  height: var(--player-h);
  display:flex; flex-direction:column; align-items:center;
  padding:14px; border-radius:18px;
  background: rgba(255,255,255,0.10);
  border: 1px solid rgba(255,255,255,0.22);
  backdrop-filter: blur(12px) saturate(1.05);
  -webkit-backdrop-filter: blur(12px) saturate(1.05);
  color:#e8edf3;
  box-shadow: 0 12px 36px rgba(0,0,0,0.28), inset 0 0 0 1px rgba(255,255,255,0.06);
}
.ap-header{ width:100%; display:flex; align-items:center; justify-content:space-between; gap:8px; }
.ap-title{ display:flex; flex-direction:column; gap:4px; }
.ap-now{ font-weight:700; letter-spacing:.25px; opacity:.95; }
.ap-trackline{ opacity:.9; font-size:.92rem; white-space:nowrap; overflow:hidden; text-overflow:ellipsis; }
.ap-artist{ font-weight:700; }
.ap-sep{ opacity:.55; margin:0 6px; }
.ap-titletext{ opacity:.9; }
.ap-error{ color:#ffb3b3; font-size:12px; padding:2px 6px; border:1px solid rgba(255,179,179,0.45); border-radius:8px; background:rgba(255,179,179,0.08); }
.ap-canvas{
  width:100%; height:120px; border-radius:12px;
  background: rgba(255,255,255,0.08);
  border:1px solid rgba(255,255,255,0.18);
  box-shadow: inset 0 0 12px rgba(0,0,0,0.22);
}
.ap-controls-row{ margin-top:10px; display:flex; gap:10px; align-items:center; justify-content:center; }
.ap-btn{
  background: rgba(255,255,255,0.14);
  border:1px solid rgba(255,255,255,0.28);
  color:#f2f6fb; padding:8px 12px; border-radius:10px; cursor:pointer;
  box-shadow:0 6px 18px rgba(0,0,0,0.22);
  transition: transform .15s ease, background .2s ease;
}
.ap-btn.big{ font-size:1.1rem; padding:10px 14px; }
.ap-btn.small{ font-size:.9rem; padding:6px 10px; }
.ap-btn:hover{ transform: translateY(-1px); background: rgba(255,255,255,0.18); }
.ap-seek-row{ margin-top:10px; width:100%; display:flex; align-items:center; justify-content:space-between; }

/* Glass, filled-track volume slider */
.ap-volume{
  --accent: var(--accent-blue);
  --bg: rgba(255,255,255,0.35);
  --vol: 0.85;                 /* set from inline style in JSX */
  appearance:none; -webkit-appearance:none; -moz-appearance:none;
  width:60%; height:8px; border-radius:999px; outline:none;
  background:
    linear-gradient(var(--accent), var(--accent)) 0/ calc(var(--vol)*100%) 100% no-repeat,
    var(--bg);
  border:1px solid rgba(255,255,255,0.25);
  box-shadow: inset 0 2px 8px rgba(0,0,0,0.2);
}
.ap-volume::-webkit-slider-thumb{
  -webkit-appearance:none; width:16px; height:16px; border-radius:50%;
  background:#fff; border:1px solid rgba(0,0,0,0.15);
  box-shadow:0 2px 8px rgba(0,0,0,0.25);
}
.ap-volume::-moz-range-thumb{
  width:16px; height:16px; border-radius:50%;
  background:#fff; border:1px solid rgba(0,0,0,0.15);
  box-shadow:0 2px 8px rgba(0,0,0,0.25);
}
.ap-volume::-moz-range-track{ background: transparent; }
.ap-volume::-moz-range-progress{
  background: var(--accent);
  height:8px; border-radius:999px;
}

/* ===================== CARDS BELOW SELECTOR (TOP-LEFT) ===================== */
/* Neutralize any legacy centering rules */
.cards-below-selector{
  left: auto !important;
  right: auto !important;
  transform: none !important;
}

/* Sit below the selector with a top gap; left aligned; never overlap player */
.cards-below-selector.left{
  position: fixed;
  top: calc(var(--selector-gap-top) + var(--cards-top-gap));
  left: max(16px, env(safe-area-inset-left));
  width: min(var(--cards-left-max-w), 96vw);
  z-index: 1003;
}
.cards-below-selector.left .cards-wrap{
  display:flex;
  justify-content:flex-start;
}

/* Wrapper and slide sized for effect-cards */
.cards-below-selector.left .swiper{
  width: var(--card-w);
  height: var(--card-h);
  margin: 0;
}
.cards-below-selector.left .swiper .swiper-slide{
  width: var(--card-w) !important;
  height: var(--card-h) !important;
  display: block;
}

/* Card design */
.card-slide{
  width:100%;
  height:100%;
  overflow:hidden;
  border-radius:12px;
  background:#dfe3ee;
  box-shadow:
    0 0.5px 0 1px rgba(255,255,255,0.25) inset,
    0 1px 0 0 rgba(255,255,255,0.65) inset,
    0 6px 18px rgba(0,0,0,0.12);
  display:grid;
  grid-template-rows: 1.8fr 1.2fr;   /* more room for text */
}
.card-slide img{
  aspect-ratio:1/1;
  border-radius:10px;
  margin:10px;
  width: calc(100% - 20px);
  height: auto;
  object-fit: cover;
}
.card-meta{
  display:flex;
  flex-direction:column;
  justify-content:center;
  align-items:flex-start;
  padding: 12px 16px 16px;
  text-align:left;
  direction: rtl; /* better for Arabic labels */
}
.card-meta .artist,
.card-meta .title{
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  width:100%;
  color: var(--accent-blue);
  font-weight: 800;            /* bold blue */
}
.card-meta .artist{ font-size: 1.12rem; line-height: 1.22; }
.card-meta .title { font-size: 1.06rem; line-height: 1.2; }

/* ===================== RIGHT GLASS PLAYLIST ===================== */
.playlist-right{
  position:fixed;
  top: var(--panel-top-gap);
  right: var(--panel-right-gap);
  width: min(var(--panel-w), 92vw);
  height: calc(100vh - var(--panel-top-gap) - var(--panel-bottom-gap));
  border-radius: 16px;
  background: linear-gradient(135deg, rgba(255,255,255,0.14), rgba(255,255,255,0.06));
  border: 1px solid rgba(255,255,255,0.28);
  backdrop-filter: blur(20px) saturate(1.25);
  -webkit-backdrop-filter: blur(20px) saturate(1.25);
  box-shadow: 0 18px 48px rgba(0,0,0,0.3), inset 0 1px 0 rgba(255,255,255,0.2);
  overflow: hidden; z-index: 1002;
}
.playlist-right .playlist-scroller{
  height: 100%; overflow-y: auto; padding: 12px;
  scrollbar-width: none;
}
.playlist-right .playlist-scroller::-webkit-scrollbar{ width:0; height:0; }

.playlist-item{
  display:grid; grid-template-columns: 64px 1fr; gap:12px; align-items:center;
  padding: 12px; border-radius: 14px;
  background: rgba(255,255,255,0.07);
  border: 1px solid rgba(255,255,255,0.16);
  color:#e5e5e5; cursor:pointer;
  transition: background .18s ease, border-color .18s ease, transform .12s ease;
  margin-bottom: 10px;
}
.playlist-item:hover{ background: rgba(255,255,255,0.12); border-color: rgba(255,255,255,0.26); transform: translateY(-1px); }
.playlist-item img{ width:64px; height:64px; border-radius:10px; object-fit:cover; }
.playlist-item .song .artist{ font-weight:800; font-size:1rem; }
.playlist-item .song .title{ opacity:.9; font-size:.92rem; }
.active-playlist-item{ background: rgba(255,255,255,0.16); border-color: rgba(255,255,255,0.32); box-shadow: inset 0 0 0 1px rgba(255,255,255,0.15); }

/* ===================== RESPONSIVE ===================== */
@media (max-width: 1024px){
  :root{
    --panel-w: 460px;
    --card-w: clamp(320px, calc(var(--player-w) - 40px), 480px);
    --card-h-desired: clamp(320px, calc(var(--card-w) * 1.12), 500px);
  }
}

@media (max-width: 768px){
  :root{
    --player-h: 238px;
  }
  .audio-player-square.stereo{
    width: var(--player-w);
    height: var(--player-h);
    padding:10px; border-radius:14px;
  }
  .ap-canvas{ height:92px; }

  /* Hide cards & playlist on mobile as requested */
  .cards-below-selector,
  .playlist-right { display: none !important; }
}

@media (max-width: 420px){
  :root{
    --card-w: clamp(300px, calc(var(--player-w) - 42px), 440px);
    --card-h-desired: clamp(300px, calc(var(--card-w) * 1.16), 480px);
  }
}
